
// simple example code for POV poi on ESP8266, tested on D1 mini and ESP-01
// hardware: for testing, APA102 strip 36px long (144px/m) using pins defined below. Make sure to put a cap between +5v and GND, mine says 1000uf and works fine. 

  //as mentioned, i'll use a ws28-something, setting them as NEOPIXEL seems to work.

// Most of this code is the hard work of Tom Hastings www.bigtop.co.za
// Many thanks to Daniel Shiffman for open source code, as well as to Dylan and Brett Pillemer for inspiration..... 
// Thanks as well to all the FastLED and Arduino guys and gals of course. 
// example image is adapted from a Visual Poi program image, used for comparison with a commercial set of poi.


#include <FastLED.h>
#include <avr/pgmspace.h> 
#define BRIGHTNESS 220 // up to 255 but that's too bright. In pitch darkness use < 100 to save your eyes (and to save battery).
//#define NUM_LEDS 37 //always one more than the actual number of LED's in strip - for some reason I get a dud pixel at the end otherwise...
#define NUM_LEDS 32       //had this strange issue too, but let's see if we can fix this differently later in the code...
#define FRAMES_PER_SECOND  120
#define SPARKING 120
#define COOLING  55
#define LED_PIN     4
//CRGBArray<NUM_LEDS> leds;
bool gReverseDirection = false;
CRGB leds[NUM_LEDS];
//D1 mini:
//#define DATA_PIN D2
//#define CLOCK_PIN D1  // we only have 1 data line, i hope the rest of the code will work for these too.
                                //actually, we don't define any pins here, but directly when we add the leds. no idea why it didn't work this way.
//ESP-01:
//#define DATA_PIN 2
//#define CLOCK_PIN 0

struct dataRGB {
  byte r;
  byte g;
  byte b;
};

struct pattern {
  byte numLeds;
  byte numFrames;
  uint8_t *patData;
};


//the following Array is compressed using R3G3B2 method: each comma separated value comprises RGB values for one pixel, compressed into one signed byte.
//uncompressed uses 3x as much space, I have not seen any real difference in colour quality using this scheme.
    //tried to find a converter that spits out that array in the right format. i found png to unsigned, and since it's just one colour i thought i could 
    //just replace 248 with -8, but that didn't work, still all red. the startup pattern works though, so it's not the cables this time...since space seems 
    // less of an issue with only 16px, we probably might as well save the pattern directly and save the conversion?
const uint8_t PROGMEM message1Data[] =
{ 237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237
,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237
,237,237,237,237,237,237,237,237,237,237,237,237,237,237,236,236,236,236,237,237,237,237,237,237,237,237,237,237,237,237,237,237
,237,237,237,237,237,237,237,237,237,237,237,237,236,236,236,236,236,236,236,236,237,237,237,237,237,237,237,237,237,237,237,237
,237,237,237,237,237,237,237,237,237,237,236,236,236,236,236,236,236,236,236,236,236,236,237,237,237,237,237,237,237,237,237,237
,237,237,237,237,237,237,237,237,237,236,236,236,236,236,236,236,236,236,236,236,236,236,236,237,237,237,237,237,237,237,237,237
,237,237,237,237,237,237,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,237,237,237,237,237,237
,237,237,237,237,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,237,237,237,237
,237,237,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,237,237
,237,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,237
,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236
,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236
,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236
,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236
,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236,240,240,236,236,236,236,236,236,236,236,236,236,236,236,236,236,236
,236,236,236,236,236,236,236,236,236,236,240,236,236,240,240,240,240,240,240,236,236,240,236,236,236,236,236,236,236,236,236,236
,236,236,236,236,236,236,236,236,236,236,236,240,240,240,240,240,240,240,240,240,240,236,236,236,236,236,236,236,236,236,236,236
,236,236,236,236,236,236,236,236,236,240,240,240,240,240,240,240,240,240,240,240,240,240,240,236,236,236,236,236,236,236,236,236
,236,236,236,236,236,236,236,236,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,236,236,236,236,236,236,236,236
,236,236,236,236,236,236,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,236,236,236,236,236,236
,236,236,236,236,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,236,236,236,236
,236,236,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,236,236
,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240
,236,236,236,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,236,236,236
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,245,240,240,240,240,240,240,240,240,240,240,213,255,255,255,255,213,240,240,240,240,240,240,240,240,240,240,245,255,255
,255,255,245,240,240,240,240,240,240,240,240,240,240,213,255,255,255,255,213,240,240,240,240,240,240,240,240,240,240,245,255,255
,255,255,245,240,240,240,240,240,240,240,240,240,240,213,255,255,255,255,213,240,240,240,240,240,240,240,240,240,240,245,255,255
,255,255,245,240,240,240,240,240,240,240,240,240,240,213,255,255,255,255,213,240,240,240,240,240,240,240,240,240,240,245,255,255
,255,255,255,240,240,240,240,240,240,240,240,240,204,255,255,255,255,255,255,204,240,240,240,240,240,240,240,240,240,255,255,255
,246,255,255,251,245,245,245,245,245,245,245,245,251,255,255,250,250,255,255,251,245,245,245,245,245,245,245,245,251,255,255,246
,204,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,240,255,255,255,255,255,255,255,255,255,255,255,255,255,255,204
,240,209,255,255,255,255,255,255,255,255,255,255,255,255,241,240,240,241,255,255,255,255,255,255,255,255,255,255,255,255,209,240
,240,240,240,241,245,245,245,245,245,245,245,245,241,240,240,240,240,240,240,241,245,245,245,245,245,245,245,245,241,240,240,240
,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240
,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,255,251,250,250,251,255,255,251,250,251,251,255,255,255,255,255,255,251,251,250,251,255,255,251,250,250,251,255,255,255
,255,255,245,240,240,240,208,255,255,241,240,240,240,213,255,255,255,255,213,240,240,240,241,255,255,208,240,240,240,245,255,255
,255,255,245,240,240,240,208,255,255,241,240,240,240,213,255,255,255,255,213,240,240,240,241,255,255,208,240,240,240,245,255,255
,255,255,245,240,240,240,208,255,255,241,240,240,240,213,255,255,255,255,213,240,240,240,241,255,255,208,240,240,240,245,255,255
,255,255,245,240,240,240,208,255,255,241,240,240,240,213,255,255,255,255,213,240,240,240,241,255,255,208,240,240,240,245,255,255
,255,255,245,240,240,240,208,255,255,245,240,240,240,213,255,255,255,255,213,240,240,240,245,255,255,208,240,240,240,245,255,255
,255,255,245,240,240,240,240,245,245,240,240,240,240,213,255,255,255,255,213,240,240,240,240,245,245,240,240,240,240,245,255,255
,255,255,245,240,240,240,240,240,240,240,240,240,240,213,255,255,255,255,213,240,240,240,240,240,240,240,240,240,240,245,255,255
,251,255,245,240,240,240,240,240,240,240,240,240,240,245,255,255,255,255,245,240,240,240,240,240,240,240,240,240,240,245,255,251
,240,240,240,240,240,240,240,240,240,240,240,245,244,240,240,240,240,240,240,244,245,240,240,240,240,240,240,240,240,240,240,240
,240,240,241,245,245,245,240,240,240,240,241,245,245,241,245,245,245,245,241,245,245,241,240,240,240,240,245,245,245,241,240,240
,240,209,255,255,255,245,241,240,240,213,255,255,255,255,245,244,244,245,255,255,255,255,213,240,240,241,245,255,255,255,209,240
,209,255,255,255,255,245,244,240,213,255,255,255,255,255,255,245,245,255,255,255,255,255,255,213,240,244,245,255,255,255,255,209
,250,255,255,250,241,245,240,208,255,255,255,250,250,255,255,250,250,255,255,250,250,255,255,255,208,240,245,241,250,255,255,250
,255,255,255,240,244,245,240,214,255,255,245,245,240,250,255,255,255,255,250,240,245,245,255,255,214,240,245,244,240,255,255,255
,255,255,245,245,245,245,208,255,255,255,245,245,241,213,255,255,255,255,213,241,245,245,255,255,255,208,245,245,245,245,255,255
,255,255,245,245,245,240,209,255,255,245,245,245,245,209,255,255,255,255,209,245,245,245,245,255,255,209,240,245,245,245,255,255
,255,255,245,245,245,240,255,255,255,245,245,245,240,246,255,255,255,255,246,240,245,245,245,255,255,255,240,245,245,245,255,255
,255,255,255,240,240,209,255,255,250,245,245,240,209,255,255,255,255,255,255,209,240,245,245,250,255,255,209,240,240,255,255,255
,250,255,255,255,250,255,255,255,245,245,209,255,255,255,255,249,249,255,255,255,255,209,245,245,255,255,255,250,255,255,255,250
,208,255,255,255,255,255,255,250,245,245,209,255,255,255,250,245,245,250,255,255,255,209,245,245,250,255,255,255,255,255,255,208
,245,241,250,255,255,255,250,245,245,245,209,255,255,250,245,245,245,245,250,255,255,209,245,245,245,250,255,255,255,250,241,245
,245,245,240,240,245,244,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,244,245,240,240,245,245
,245,245,245,245,245,245,245,245,245,245,245,245,245,245,250,250,250,250,245,245,245,245,245,245,245,245,245,245,245,245,245,245
,245,245,245,245,245,245,245,245,245,245,245,245,245,214,255,255,255,255,214,245,245,245,245,245,245,245,245,245,245,245,245,245
,245,245,245,245,245,245,245,245,245,245,245,245,245,213,255,255,255,255,213,245,245,245,245,245,245,245,245,245,245,245,245,245
,245,245,245,245,245,245,245,245,245,245,245,245,245,213,255,255,255,255,213,245,245,245,245,245,245,245,245,245,245,245,245,245
,245,245,245,245,245,245,245,245,245,245,245,245,245,214,255,255,255,255,214,245,245,245,245,245,245,245,245,245,245,245,245,245
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,250,250,250,250,250,250,250,250,250,250,250,250,250,250,255,255,255,255,250,250,250,250,250,250,250,250,250,250,250,250,250,250
,245,245,245,245,245,245,245,245,245,245,245,245,245,214,255,255,255,255,214,245,245,245,245,245,245,245,245,245,245,245,245,245
,245,245,245,245,245,245,245,245,245,245,245,245,245,214,255,255,255,255,214,245,245,245,245,245,245,245,245,245,245,245,245,245
,245,245,245,245,245,245,245,245,245,245,245,245,245,214,255,255,255,255,214,245,245,245,245,245,245,245,245,245,245,245,245,245
,245,245,245,245,245,245,245,245,245,245,245,245,245,246,255,255,255,255,246,245,245,245,245,245,245,245,245,245,245,245,245,245
,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245
,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245
,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,245,245,245,245,245,245,213,255,255,245,245,245,213,218,255,255,255,255,218,213,245,245,245,255,255,213,245,245,245,245,245,245
,245,245,245,245,245,245,213,255,255,245,245,245,245,214,255,255,255,255,214,245,245,245,245,255,255,213,245,245,245,245,245,245
,245,245,245,245,245,245,209,255,255,245,245,245,245,214,255,255,255,255,214,245,245,245,245,255,255,209,245,245,245,245,245,245
,245,245,245,245,245,213,255,255,255,245,245,245,245,214,255,255,255,255,214,245,245,245,245,255,255,255,213,245,245,245,245,245
,245,245,245,213,255,255,255,255,255,245,245,245,245,250,255,255,255,255,250,245,245,245,245,255,255,255,255,255,213,245,245,245
,245,250,255,255,255,255,255,255,255,255,245,245,213,255,255,255,255,255,255,213,245,245,255,255,255,255,255,255,255,255,250,245
,255,255,255,255,255,249,245,250,255,255,255,255,255,255,255,250,250,255,255,255,255,255,255,255,250,245,249,255,255,255,255,255
,255,255,255,249,245,249,245,213,255,255,255,255,255,255,254,249,249,254,255,255,255,255,255,255,213,245,249,245,249,255,255,255
,255,249,245,245,249,249,249,245,245,250,255,255,254,249,249,249,249,249,249,254,255,255,250,245,245,249,249,249,245,245,249,255
,245,249,249,249,249,249,249,249,249,249,245,245,249,249,249,249,249,249,249,249,245,245,249,249,249,249,249,249,249,249,249,245
,249,249,245,245,245,245,245,245,245,245,249,245,245,249,249,249,249,249,249,245,245,249,245,245,245,245,245,245,245,245,249,249
,245,245,250,255,255,255,255,255,255,255,255,255,255,250,249,249,249,249,250,255,255,255,255,255,255,255,255,255,255,250,245,245
,245,250,255,255,255,255,255,255,255,255,255,255,255,255,254,249,249,254,255,255,255,255,255,255,255,255,255,255,255,255,250,245
,214,255,255,255,254,250,250,250,250,250,250,254,255,255,255,250,250,255,255,255,254,250,250,250,250,250,250,254,255,255,255,214
,255,255,255,245,249,249,249,249,249,249,249,249,213,255,255,255,255,255,255,213,249,249,249,249,249,249,249,249,245,255,255,255
,255,255,250,249,249,249,249,249,249,249,249,249,245,218,255,255,255,255,218,245,249,249,249,249,249,249,249,249,249,250,255,255
,255,255,249,249,249,249,249,249,249,249,249,249,249,213,255,255,255,255,213,249,249,249,249,249,249,249,249,249,249,249,255,255
,255,255,250,249,249,249,249,249,249,249,249,249,249,218,255,255,255,255,218,249,249,249,249,249,249,249,249,249,249,250,255,255
,255,255,255,249,249,249,249,249,249,249,249,249,213,255,255,255,255,255,255,213,249,249,249,249,249,249,249,249,249,255,255,255
,250,255,255,255,250,249,249,249,249,249,217,217,255,255,255,250,250,255,255,255,217,217,249,249,249,249,249,250,255,255,255,250
,213,255,255,255,255,255,255,255,255,255,255,255,255,255,255,249,249,255,255,255,255,255,255,255,255,255,255,255,255,255,255,213
,249,245,254,255,255,255,255,255,255,255,255,255,255,254,249,249,249,249,254,255,255,255,255,255,255,255,255,255,255,254,245,249
,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249
,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249,249
,249,249,249,249,249,249,249,249,249,249,249,249,213,213,255,255,255,255,213,213,249,249,249,249,249,249,249,249,249,249,249,249
,249,249,249,249,249,249,249,249,249,249,213,213,255,255,255,255,255,255,255,255,213,213,249,249,249,249,249,249,249,249,249,249
,249,249,249,249,249,249,249,249,213,213,254,255,255,255,255,254,254,255,255,255,255,254,213,213,249,249,249,249,249,249,249,249
,249,249,249,249,249,249,249,213,250,255,255,255,255,255,217,217,217,217,255,255,255,255,255,250,213,249,249,249,249,249,249,249
,250,250,250,250,250,250,250,255,255,255,255,255,217,217,249,249,249,249,217,217,255,255,255,255,255,250,250,250,250,250,250,250
,255,255,255,255,255,255,255,255,255,255,217,217,249,217,217,217,217,217,217,249,217,217,255,255,255,255,255,255,255,255,255,255
,255,255,255,255,255,255,255,255,255,255,254,217,217,217,217,217,217,217,217,217,217,254,255,255,255,255,255,255,255,255,255,255
,213,213,213,213,213,213,213,255,255,255,255,255,254,217,217,217,217,217,217,254,255,255,255,255,255,213,213,213,213,213,213,213
,249,249,249,249,249,249,217,213,213,255,255,255,255,255,254,217,217,254,255,255,255,255,255,213,213,217,249,249,249,249,249,249
,249,249,249,249,249,249,217,217,217,213,213,255,255,255,255,255,255,255,255,255,255,213,213,217,217,217,249,249,249,249,249,249
,249,249,249,249,217,217,217,217,217,217,217,213,181,255,255,255,255,255,255,181,213,217,217,217,217,217,217,217,249,249,249,249
,249,249,249,217,217,217,217,217,217,217,217,217,217,213,213,255,255,213,213,217,217,217,217,217,217,217,217,217,217,249,249,249
,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217
,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217
,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217
,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217
,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217,217
,217,217,217,217,213,213,213,213,181,181,181,213,217,217,217,217,217,217,217,217,213,181,181,181,213,213,213,213,217,217,217,217
,217,213,213,255,255,255,255,255,255,255,255,255,255,217,217,217,217,217,217,255,255,255,255,255,255,255,255,255,255,213,213,217
,213,218,255,255,255,255,255,255,255,255,255,255,255,255,218,185,185,218,255,255,255,255,255,255,255,255,255,255,255,255,218,213
,181,255,255,255,255,255,255,255,255,255,255,255,255,255,255,217,217,255,255,255,255,255,255,255,255,255,255,255,255,255,255,181
,255,255,255,217,213,213,185,181,181,181,181,181,181,255,255,255,255,255,255,181,181,181,181,181,181,185,213,213,217,255,255,255
,255,255,218,217,217,217,217,217,217,217,185,185,181,218,255,255,255,255,218,181,185,185,217,217,217,217,217,217,217,218,255,255
,255,255,217,217,217,217,217,217,185,185,185,185,181,181,255,255,255,255,181,181,185,185,185,185,217,217,217,217,217,217,255,255
,255,255,217,217,217,217,185,185,185,185,185,185,181,181,255,255,255,255,181,181,185,185,185,185,185,185,217,217,217,217,255,255
,255,255,255,185,185,185,185,185,185,185,185,185,181,255,255,255,255,255,255,181,185,185,185,185,185,185,185,185,185,255,255,255
,218,255,255,255,181,185,185,185,185,185,181,181,255,255,255,222,222,255,255,255,181,181,185,185,185,185,185,181,255,255,255,218
,181,255,255,255,255,218,185,185,185,181,181,255,255,255,255,185,185,255,255,255,255,181,181,185,185,185,218,255,255,255,255,181
,181,181,255,255,255,218,185,185,185,181,181,255,255,255,185,185,185,185,255,255,255,181,181,185,185,185,218,255,255,255,181,181
,185,185,181,181,218,185,185,185,185,185,181,186,185,185,185,185,185,185,185,185,186,181,185,185,185,185,185,218,181,181,185,185
,181,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,181
,255,255,218,181,181,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,181,181,218,255,255
,255,255,255,255,255,222,185,181,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,185,181,185,222,255,255,255,255,255
,223,255,255,255,255,255,255,255,222,185,149,185,185,185,185,185,185,185,185,185,185,149,185,222,255,255,255,255,255,255,255,223
,181,181,186,255,255,255,255,255,255,255,255,222,185,149,153,185,185,153,149,185,222,255,255,255,255,255,255,255,255,186,181,181
,185,181,181,255,255,185,218,255,255,255,255,255,255,255,222,185,185,222,255,255,255,255,255,255,255,218,185,255,255,181,181,185
,185,181,181,255,255,185,181,149,149,218,255,255,255,255,255,255,255,255,255,255,255,255,218,149,149,181,185,255,255,181,181,185
,185,181,181,255,255,185,185,185,185,149,149,149,255,255,255,255,255,255,255,255,149,149,149,185,185,185,185,255,255,181,181,185
,185,181,149,255,255,153,149,149,181,218,255,255,255,255,255,255,255,255,255,255,255,255,218,181,149,149,153,255,255,149,181,185
,185,149,149,255,255,181,222,255,255,255,255,255,255,255,223,185,185,223,255,255,255,255,255,255,255,222,181,255,255,149,149,185
,149,149,182,255,255,255,255,255,255,255,255,222,149,149,153,153,153,153,149,149,222,255,255,255,255,255,255,255,255,182,149,149
,255,255,255,255,255,255,255,255,218,149,149,153,153,153,153,153,153,153,153,153,153,149,149,218,255,255,255,255,255,255,255,255
,255,255,255,255,255,218,149,149,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,149,149,218,255,255,255,255,255
,255,255,186,149,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,149,186,255,255
,149,149,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,149,149
,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,223,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,223
,149,149,149,149,149,117,186,255,222,117,117,117,117,149,255,255,255,255,149,117,117,117,117,222,255,186,117,149,149,149,149,149
,153,153,153,153,153,149,186,255,222,153,153,153,117,150,255,255,255,255,150,117,153,153,153,222,255,186,149,153,153,153,153,153
,153,153,153,153,153,117,186,255,222,153,153,153,117,150,255,255,255,255,150,117,153,153,153,222,255,186,117,153,153,153,153,153
,153,153,153,153,153,117,186,255,223,153,153,121,117,154,255,255,255,255,154,117,121,153,153,223,255,186,117,153,153,153,153,153
,153,153,153,153,153,117,150,255,255,117,121,117,117,223,255,255,255,255,223,117,117,121,117,255,255,150,117,153,153,153,153,153
,153,153,153,153,153,117,117,255,255,223,149,149,186,255,255,222,222,255,255,186,149,149,223,255,255,117,117,153,153,153,153,153
,153,153,153,153,153,121,117,223,255,255,255,255,255,255,255,153,153,255,255,255,255,255,255,255,223,117,121,153,153,153,153,153
,153,153,153,121,121,121,117,117,223,255,255,255,255,255,153,121,121,153,255,255,255,255,255,223,117,117,121,121,121,153,153,153
,153,153,121,121,121,121,121,117,117,117,154,154,149,117,121,121,121,121,117,149,154,154,117,117,117,121,121,121,121,121,153,153
,121,121,121,121,121,121,121,121,117,117,117,117,117,117,121,117,117,121,117,117,117,117,117,117,121,121,121,121,121,121,121,121
,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153
,121,117,117,117,121,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,121,117,117,117,121
,121,117,121,121,121,121,117,117,117,117,117,117,117,117,186,186,186,186,117,117,117,117,117,117,117,117,121,121,121,121,117,121
,121,121,117,117,117,117,117,117,117,117,117,117,117,150,255,255,255,255,150,117,117,117,117,117,117,117,117,117,117,117,121,121
,121,117,117,117,117,117,117,117,117,117,117,117,117,150,255,255,255,255,150,117,117,117,117,117,117,117,117,117,117,117,117,121
,117,117,117,117,117,117,117,117,117,117,117,117,117,150,255,255,255,255,150,117,117,117,117,117,117,117,117,117,117,117,117,117
,117,117,117,117,117,117,117,117,117,117,117,117,117,150,255,255,255,255,150,117,117,117,117,117,117,117,117,117,117,117,117,117
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,186,218,218,218,218,218,218,219,219,219,219,219,187,223,255,255,255,255,223,187,219,219,219,219,219,218,218,218,218,218,218,186
,117,117,117,117,117,117,117,117,117,117,117,117,85,150,255,255,255,255,150,85,117,117,117,117,117,117,117,117,117,117,117,117
,117,117,117,117,117,117,117,117,117,117,117,117,85,150,255,255,255,255,150,85,117,117,117,117,117,117,117,117,117,117,117,117
,117,117,117,117,117,117,117,117,117,117,117,117,85,150,255,255,255,255,150,85,117,117,117,117,117,117,117,117,117,117,117,117
,117,117,117,117,117,117,117,117,117,117,117,117,117,150,255,255,255,255,150,117,117,117,117,117,117,117,117,117,117,117,117,117
,223,154,85,117,117,117,117,117,117,117,117,117,117,85,118,118,118,118,85,117,117,117,117,117,117,117,117,117,117,85,154,223
,255,255,255,223,154,85,117,117,117,117,117,117,117,117,117,118,118,117,117,117,117,117,117,117,117,117,85,154,223,255,255,255
,255,255,255,255,255,255,223,186,117,85,117,117,117,117,86,86,86,86,117,117,117,117,85,117,186,223,255,255,255,255,255,255
,117,186,255,255,255,255,255,255,255,223,186,118,85,86,86,86,86,86,86,85,118,186,223,255,255,255,255,255,255,255,186,117
,117,85,117,255,255,223,255,255,255,255,255,255,223,186,118,86,86,118,186,223,255,255,255,255,255,255,223,255,255,117,85,117
,117,85,118,255,255,85,85,154,219,255,255,255,255,255,255,223,223,255,255,255,255,255,255,219,154,85,85,255,255,118,85,117
,117,85,118,255,255,85,86,86,85,81,118,187,255,255,255,255,255,255,255,255,187,118,81,85,86,86,85,255,255,118,85,117
,117,85,118,255,255,86,86,86,85,118,150,219,255,255,255,255,255,255,255,255,219,150,118,85,86,86,86,255,255,118,85,117
,117,85,118,255,255,85,118,150,255,255,255,255,255,255,255,223,223,255,255,255,255,255,255,255,150,118,85,255,255,118,85,117
,85,85,118,255,255,255,255,255,255,255,255,255,223,154,86,86,86,86,154,223,255,255,255,255,255,255,255,255,255,118,85,85
,118,187,255,255,255,255,255,255,255,223,150,86,86,86,86,86,86,86,86,86,86,150,223,255,255,255,255,255,255,255,187,118
,255,255,255,255,255,255,223,118,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,118,223,255,255,255,255,255,255
,255,255,255,223,118,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,118,223,255,255,255
,186,118,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,118,186
,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86
,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,187,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,187,255,255
,255,255,154,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,154,255,255
,255,255,154,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,154,255,255
,255,255,154,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,154,255,255
,255,255,154,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,154,255,255
,255,255,154,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,154,255,255
,255,255,155,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,155,255,255
,255,255,155,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,155,255,255
,118,118,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,118,118
,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86
,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,119,119,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,119,119,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118
,86,86,86,86,86,86,86,86,86,87,87,87,87,87,87,87,87,87,87,87,87,87,87,86,86,86,86,86,86,86,86,86
,86,86,50,118,151,86,87,87,87,83,50,82,82,83,87,87,87,87,83,82,82,50,83,87,87,87,86,151,118,50,86,86
,82,118,255,255,255,119,87,87,50,151,255,255,255,223,87,87,87,87,223,255,255,255,151,50,87,87,119,255,255,255,118,82
,82,255,255,255,255,119,87,82,119,255,255,255,255,255,255,87,87,255,255,255,255,255,255,119,82,87,119,255,255,255,255,82
,187,255,255,187,119,87,83,50,255,255,255,187,187,255,255,187,187,255,255,187,187,255,255,255,50,83,87,119,187,255,255,187
,255,255,223,83,87,87,82,151,255,255,87,83,50,187,255,255,255,255,187,50,83,87,255,255,151,82,87,87,83,223,255,255
,255,255,119,87,87,83,50,255,255,223,83,83,51,114,255,255,255,255,114,51,83,83,223,255,255,50,83,87,87,119,255,255
,255,255,119,87,87,83,82,255,255,119,83,83,51,82,255,255,255,255,82,51,83,83,119,255,255,82,83,87,87,119,255,255
,255,255,119,87,83,50,219,255,255,83,83,83,51,151,255,255,255,255,151,51,83,83,83,255,255,219,50,83,87,119,255,255
,223,255,219,83,51,82,255,255,187,51,83,51,50,255,255,223,223,255,255,50,51,83,51,187,255,255,82,51,83,219,255,223
,155,255,255,255,187,255,255,255,83,51,83,223,255,255,255,119,119,255,255,255,223,83,51,83,255,255,255,187,255,255,255,155
,50,255,255,255,255,255,255,155,51,51,82,255,255,255,187,51,51,187,255,255,255,82,51,51,155,255,255,255,255,255,255,50
,83,82,223,255,255,255,151,51,51,51,82,255,255,151,51,51,51,51,151,255,255,82,51,51,51,151,255,255,255,223,82,83
,83,83,51,83,83,83,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,83,83,83,51,83,83
,83,83,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,83,83
,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,119,119,119,119,119,119,119,119,119,119,151,255,255,255,255,155,155,255,255,255,255,151,119,119,119,119,119,119,119,119,119,119
,51,51,51,51,51,51,51,51,51,151,255,255,255,223,83,51,51,83,223,255,255,255,151,51,51,51,51,51,51,51,51,51
,51,51,51,51,51,51,51,83,255,255,255,255,155,51,51,51,51,51,51,155,255,255,255,255,83,51,51,51,51,51,51,51
,51,51,51,51,51,51,83,255,255,255,223,83,51,51,51,51,51,51,51,51,83,223,255,255,255,83,51,51,51,51,51,51
,51,51,51,51,51,51,83,255,255,255,187,83,51,51,83,83,83,83,51,51,83,187,255,255,255,83,51,51,51,51,51,51
,51,51,51,51,51,51,51,151,255,255,255,255,115,83,83,83,83,83,83,115,255,255,255,255,151,51,51,51,51,51,51,51
,51,51,51,51,51,51,51,51,47,223,255,255,255,187,83,83,83,83,187,255,255,255,223,47,51,51,51,51,51,51,51,51
,51,83,83,83,83,83,83,83,83,79,115,255,255,255,255,115,115,255,255,255,255,115,79,83,83,83,83,83,83,83,83,51
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
,151,187,187,187,187,187,187,187,183,183,183,183,183,183,183,151,151,183,183,183,183,183,183,183,187,187,187,187,187,187,187,151
,51,51,51,83,83,83,83,83,83,83,79,79,79,79,79,79,79,79,79,79,79,79,83,83,83,83,83,83,83,51,51,51
,83,83,83,83,83,83,83,83,83,83,79,79,79,79,79,79,79,79,79,79,79,79,83,83,83,83,83,83,83,83,83,83
,83,83,83,83,83,83,83,83,83,79,79,79,79,79,79,79,79,79,79,79,79,79,79,83,83,83,83,83,83,83,83,83
,83,83,83,83,83,83,83,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,83,83,83,83,83,83,83
,83,83,83,83,83,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,83,83,83,83,83
,83,83,83,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,83,83,83
,83,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,83
,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79
,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79
,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79
,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79
,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79
,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,111,111,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79
,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,111,111,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79
,79,79,79,79,79,79,79,79,79,79,79,79,111,111,107,107,107,107,111,111,79,79,79,79,79,79,79,79,79,79,79,79
,79,79,79,79,79,79,79,79,79,79,111,111,111,107,107,107,107,107,107,111,111,111,79,79,79,79,79,79,79,79,79,79
,79,79,79,79,79,79,79,79,111,111,107,107,107,107,107,107,107,107,107,107,107,107,111,111,79,79,79,79,79,79,79,79
,79,79,79,79,79,79,79,111,111,107,107,107,107,107,107,107,107,107,107,107,107,107,107,111,111,79,79,79,79,79,79,79
,79,79,79,79,111,111,111,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,111,111,111,79,79,79,79
,79,79,79,111,111,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,111,111,79,79,79
,79,111,111,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,111,111,79

};
struct pattern message1 = {32, 262, message1Data}; //need this for multiple images later

byte X;

void setup() {
  //Serial.begin(115200);
  //Serial.println("Startup");
  FastLED.addLeds<NEOPIXEL, 4>(leds, NUM_LEDS); 
  FastLED.setBrightness(  BRIGHTNESS );
  //startupPattern();
  // List of patterns to cycle through.  Each is defined as a separate function below.
}
typedef void (*SimplePatternList[])();
SimplePatternList gPatterns = { image };
//SimplePatternList gPatterns = { pacifica_loop, startupPattern, pride, image, rainbow, rainbowWithGlitter, confetti, sinelon, juggle, bpm, Fire2012 };

uint8_t gCurrentPatternNumber = 0; // Index number of which pattern is current
uint8_t gHue = 0; // rotating "base color" used by many of the patterns

//SimplePatternList gPatterns = { pacifica_loop, startupPattern, pride, image, rainbow, rainbowWithGlitter, confetti, sinelon, juggle, bpm, Fire2012 };





void loop()
{
  // Call the current pattern function once, updating the 'leds' array
  gPatterns[gCurrentPatternNumber]();

  // send the 'leds' array out to the actual LED strip
  FastLED.show();  
  // insert a delay to keep the framerate modest
  FastLED.delay(1000/FRAMES_PER_SECOND); 

  // do some periodic updates
  EVERY_N_MILLISECONDS( 2 ) { gHue++; } // slowly cycle the "base color" through the rainbow
  EVERY_N_SECONDS( 60 ) { nextPattern(); } // change patterns periodically
}

#define ARRAY_SIZE(A) (sizeof(A) / sizeof((A)[0]))

void nextPattern()
{
  // add one to the current pattern number, and wrap around at the end
  gCurrentPatternNumber = (gCurrentPatternNumber + 1) % ARRAY_SIZE( gPatterns);
}

void image()
{
  int counter = 0;
  for (int j = 0; j < 262; j++ ) { //number of rows
    for (int i = 0; i < 32; i++) { //number of LED's 
                                                          

      ///////////////////////////////convert byte to signed byte:////
      X = pgm_read_dword (&(message1Data[counter++]));
      ///////////////////////////////end convert byte to signed byte////

                                  


      // array compressed using R3G3B2 compression, uncompress here:
      byte R1 = (X & 0xE0);
                                 
      leds[i].r = R1; //
      byte G1 =  ((X << 3) & 0xE0);
                                  
      leds[i].g = G1;
                                          
      byte M1 = (X << 6);             
                                  
      leds[i].b = M1;
      //FastLED.delay(42);
                                  //
      //Serial.print(R1); Serial.print(", "); Serial.print(G1); Serial.print(", "); Serial.println(M1);
    }
    FastLED.show();
    FastLED.clear();    
                                  // added the FastLED.clear here to turn off the leds
  }
  FastLED.delay(32);
                                  // adjust this delay for spacing, how long to pause between each time the array is shown.
}


void rainbow() 
{
  // FastLED's built-in rainbow generator
  fill_rainbow( leds, NUM_LEDS, gHue, 7);
}

void rainbowWithGlitter() 
{
  // built-in FastLED rainbow, plus some random sparkly glitter
  rainbow();
  addGlitter(80);
}

void addGlitter( fract8 chanceOfGlitter) 
{
  if( random8() < chanceOfGlitter) {
    leds[ random16(NUM_LEDS) ] += CRGB::White;
  }
}

void confetti() 
{
  // random colored speckles that blink in and fade smoothly
  fadeToBlackBy( leds, NUM_LEDS, 10);
  int pos = random16(NUM_LEDS);
  leds[pos] += CHSV( gHue + random8(64), 200, 255);
}

void sinelon()
{
  // a colored dot sweeping back and forth, with fading trails
  fadeToBlackBy( leds, NUM_LEDS, 20);
  int pos = beatsin16( 13, 0, NUM_LEDS-1 );
  leds[pos] += CHSV( gHue, 255, 192);
}

void bpm()
{
  // colored stripes pulsing at a defined Beats-Per-Minute (BPM)
  uint8_t BeatsPerMinute = 62;
  CRGBPalette16 palette = PartyColors_p;
  uint8_t beat = beatsin8( BeatsPerMinute, 64, 255);
  for( int i = 0; i < NUM_LEDS; i++) { //9948
    leds[i] = ColorFromPalette(palette, gHue+(i*2), beat-gHue+(i*10));
  }
}

void juggle() {
  // eight colored dots, weaving in and out of sync with each other
  fadeToBlackBy( leds, NUM_LEDS, 20);
  byte dothue = 0;
  for( int i = 0; i < 8; i++) {
    leds[beatsin16( i+7, 0, NUM_LEDS-1 )] |= CHSV(dothue, 200, 255);
    dothue += 32;
  }
 }


  

void Fire2012()
{
// Array of temperature readings at each simulation cell
  static byte heat[NUM_LEDS];

  // Step 1.  Cool down every cell a little
    for( int i = 0; i < NUM_LEDS; i++) {
      heat[i] = qsub8( heat[i],  random8(0, ((COOLING * 10) / NUM_LEDS) + 2));
    }
  
    // Step 2.  Heat from each cell drifts 'up' and diffuses a little
    for( int k= NUM_LEDS - 1; k >= 2; k--) {
      heat[k] = (heat[k - 1] + heat[k - 2] + heat[k - 2] ) / 3;
    }
    
    // Step 3.  Randomly ignite new 'sparks' of heat near the bottom
    if( random8() < SPARKING ) {
      int y = random8(7);
      heat[y] = qadd8( heat[y], random8(160,255) );
    }

    // Step 4.  Map from heat cells to LED colors
    for( int j = 0; j < NUM_LEDS; j++) {
      CRGB color = HeatColor( heat[j]);
      int pixelnumber;
      if( gReverseDirection ) {
        pixelnumber = (NUM_LEDS-1) - j;
      } else {
        pixelnumber = j;
      }
      leds[pixelnumber] = color;
    }

}
void startupPattern() 
{
  delay(100);
  FastLED.showColor(CRGB::Red);
  delay(1000);
  FastLED.showColor(CRGB::Black);
  delay(100);
  FastLED.showColor(CRGB::Green);
  delay(1000);
  FastLED.showColor(CRGB::Black);
  delay(100);
  FastLED.showColor(CRGB::Blue);
  delay(1000);
  FastLED.showColor(CRGB::Black);
  delay(100);
  for (int i = 0; i < NUM_LEDS; i++) {
    // Set the i'th led to whatever
    leds[i] = CRGB::Cyan;
    // Show the leds
    FastLED.show();
    // now that we've shown the leds, reset the i'th led to black
    leds[i] = CRGB::Black;
    // Wait a little bit before we loop around and do it again
    delay(10);
  }
  for (int i = 0; i < NUM_LEDS; i++) {
    // Set the i'th led to whatever
    leds[i] = CRGB::Yellow;
    // Show the leds
    FastLED.show();
    // now that we've shown the leds, reset the i'th led to black
    leds[i] = CRGB::Black;
    // Wait a little bit before we loop around and do it again
    delay(10);
  }
  for (int i = 0; i < NUM_LEDS; i++) {
    // Set the i'th led to whatever
    leds[i] = CRGB::Magenta;
    // Show the leds
    FastLED.show();
    // now that we've shown the leds, reset the i'th led to black
    leds[i] = CRGB::Magenta;
    // Wait a little bit before we loop around and do it again
    delay(10);
  }
  delay(200);
  FastLED.showColor( CRGB::Black );
  delay(100);
}

void pride() 
{
  static uint16_t sPseudotime = 0;
  static uint16_t sLastMillis = 0;
  static uint16_t sHue16 = 0;
 
  uint8_t sat8 = beatsin88( 87, 220, 250);
  uint8_t brightdepth = beatsin88( 341, 96, 224);
  uint16_t brightnessthetainc16 = beatsin88( 203, (25 * 256), (40 * 256));
  uint8_t msmultiplier = beatsin88(147, 23, 60);

  uint16_t hue16 = sHue16;//gHue * 256;
  uint16_t hueinc16 = beatsin88(113, 1, 3000);
  
  uint16_t ms = millis();
  uint16_t deltams = ms - sLastMillis ;
  sLastMillis  = ms;
  sPseudotime += deltams * msmultiplier;
  sHue16 += deltams * beatsin88( 400, 5,9);
  uint16_t brightnesstheta16 = sPseudotime;
  
  for( uint16_t i = 0 ; i < NUM_LEDS; i++) {
    hue16 += hueinc16;
    uint8_t hue8 = hue16 / 256;

    brightnesstheta16  += brightnessthetainc16;
    uint16_t b16 = sin16( brightnesstheta16  ) + 32768;

    uint16_t bri16 = (uint32_t)((uint32_t)b16 * (uint32_t)b16) / 65536;
    uint8_t bri8 = (uint32_t)(((uint32_t)bri16) * brightdepth) / 65536;
    bri8 += (255 - brightdepth);
    
    CRGB newcolor = CHSV( hue8, sat8, bri8);
    
    uint16_t pixelnumber = i;
    pixelnumber = (NUM_LEDS-1) - pixelnumber;
    
    nblend( leds[pixelnumber], newcolor, 64);
  }
}

//////////////////////////////////////////////////////
// pacifica
//////////////////////////////////////////////////////
CRGBPalette16 pacifica_palette_1 = 
    { 0x000507, 0x000409, 0x00030B, 0x00030D, 0x000210, 0x000212, 0x000114, 0x000117, 
      0x000019, 0x00001C, 0x000026, 0x000031, 0x00003B, 0x000046, 0x14554B, 0x28AA50 };
CRGBPalette16 pacifica_palette_2 = 
    { 0x000507, 0x000409, 0x00030B, 0x00030D, 0x000210, 0x000212, 0x000114, 0x000117, 
      0x000019, 0x00001C, 0x000026, 0x000031, 0x00003B, 0x000046, 0x0C5F52, 0x19BE5F };
CRGBPalette16 pacifica_palette_3 = 
    { 0x000208, 0x00030E, 0x000514, 0x00061A, 0x000820, 0x000927, 0x000B2D, 0x000C33, 
      0x000E39, 0x001040, 0x001450, 0x001860, 0x001C70, 0x002080, 0x1040BF, 0x2060FF };


void pacifica_loop()
{
  // Increment the four "color index start" counters, one for each wave layer.
  // Each is incremented at a different speed, and the speeds vary over time.
  static uint16_t sCIStart1, sCIStart2, sCIStart3, sCIStart4;
  static uint32_t sLastms = 0;
  uint32_t ms = GET_MILLIS();
  uint32_t deltams = ms - sLastms;
  sLastms = ms;
  uint16_t speedfactor1 = beatsin16(3, 179, 269);
  uint16_t speedfactor2 = beatsin16(4, 179, 269);
  uint32_t deltams1 = (deltams * speedfactor1) / 256;
  uint32_t deltams2 = (deltams * speedfactor2) / 256;
  uint32_t deltams21 = (deltams1 + deltams2) / 2;
  sCIStart1 += (deltams1 * beatsin88(1011,10,13));
  sCIStart2 -= (deltams21 * beatsin88(777,8,11));
  sCIStart3 -= (deltams1 * beatsin88(501,5,7));
  sCIStart4 -= (deltams2 * beatsin88(257,4,6));

  // Clear out the LED array to a dim background blue-green
  fill_solid( leds, NUM_LEDS, CRGB( 2, 6, 10));

  // Render each of four layers, with different scales and speeds, that vary over time
  pacifica_one_layer( pacifica_palette_1, sCIStart1, beatsin16( 3, 11 * 256, 14 * 256), beatsin8( 10, 70, 130), 0-beat16( 301) );
  pacifica_one_layer( pacifica_palette_2, sCIStart2, beatsin16( 4,  6 * 256,  9 * 256), beatsin8( 17, 40,  80), beat16( 401) );
  pacifica_one_layer( pacifica_palette_3, sCIStart3, 6 * 256, beatsin8( 9, 10,38), 0-beat16(503));
  pacifica_one_layer( pacifica_palette_3, sCIStart4, 5 * 256, beatsin8( 8, 10,28), beat16(601));

  // Add brighter 'whitecaps' where the waves lines up more
  pacifica_add_whitecaps();

  // Deepen the blues and greens a bit
  pacifica_deepen_colors();
}

// Add one layer of waves into the led array
void pacifica_one_layer( CRGBPalette16& p, uint16_t cistart, uint16_t wavescale, uint8_t bri, uint16_t ioff)
{
  uint16_t ci = cistart;
  uint16_t waveangle = ioff;
  uint16_t wavescale_half = (wavescale / 2) + 20;
  for( uint16_t i = 0; i < NUM_LEDS; i++) {
    waveangle += 250;
    uint16_t s16 = sin16( waveangle ) + 32768;
    uint16_t cs = scale16( s16 , wavescale_half ) + wavescale_half;
    ci += cs;
    uint16_t sindex16 = sin16( ci) + 32768;
    uint8_t sindex8 = scale16( sindex16, 240);
    CRGB c = ColorFromPalette( p, sindex8, bri, LINEARBLEND);
    leds[i] += c;
  }
}

// Add extra 'white' to areas where the four layers of light have lined up brightly
void pacifica_add_whitecaps()
{
  uint8_t basethreshold = beatsin8( 9, 55, 65);
  uint8_t wave = beat8( 7 );
  
  for( uint16_t i = 0; i < NUM_LEDS; i++) {
    uint8_t threshold = scale8( sin8( wave), 20) + basethreshold;
    wave += 7;
    uint8_t l = leds[i].getAverageLight();
    if( l > threshold) {
      uint8_t overage = l - threshold;
      uint8_t overage2 = qadd8( overage, overage);
      leds[i] += CRGB( overage, overage2, qadd8( overage2, overage2));
    }
  }
}

// Deepen the blues and greens
void pacifica_deepen_colors()
{
  for( uint16_t i = 0; i < NUM_LEDS; i++) {
    leds[i].blue = scale8( leds[i].blue,  145); 
    leds[i].green= scale8( leds[i].green, 200); 
    leds[i] |= CRGB( 2, 5, 7);
  }
}
